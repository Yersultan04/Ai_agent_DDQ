{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/yersultanakhmer/Desktop/AIHackathon/ddq-copilot/src/app/projects/%5BprojectId%5D/kb/Uploader.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nexport function Uploader({ projectId }: { projectId: string }) {\n  const [title, setTitle] = useState(\"\");\n  const [file, setFile] = useState<File | null>(null);\n  const [status, setStatus] = useState<string | null>(null);\n  const [busy, setBusy] = useState(false);\n\n  async function upload() {\n    if (!file) {\n      setStatus(\"Pick a file first.\");\n      return;\n    }\n    setBusy(true);\n    setStatus(null);\n\n    const fd = new FormData();\n    fd.set(\"title\", title);\n    fd.set(\"file\", file);\n\n    const res = await fetch(`/api/projects/${projectId}/kb`, {\n      method: \"POST\",\n      body: fd,\n    });\n\n    const json = await res.json().catch(() => null);\n\n    if (!res.ok) {\n      setStatus(json?.error ?? `Upload failed (${res.status})`);\n      setBusy(false);\n      return;\n    }\n\n    const msgParts = [\n      `Uploaded: ${json?.doc?.filename ?? \"document\"}`,\n      `Chunks: ${json?.chunkCount ?? 0}`,\n      json?.warning ? `Note: ${json.warning}` : null,\n    ].filter(Boolean);\n\n    setStatus(msgParts.join(\" • \"));\n    setTitle(\"\");\n    setFile(null);\n    setBusy(false);\n\n    // Refresh the page list\n    window.location.reload();\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"grid gap-2\">\n        <label className=\"text-sm font-medium\">Title (optional)</label>\n        <input\n          value={title}\n          onChange={(e) => setTitle(e.target.value)}\n          className=\"w-full rounded-md border px-3 py-2 text-sm\"\n          placeholder=\"e.g., SOC2 Type II Report 2025\"\n        />\n      </div>\n\n      <div className=\"grid gap-2\">\n        <label className=\"text-sm font-medium\">File</label>\n        <input\n          type=\"file\"\n          onChange={(e) => setFile(e.target.files?.[0] ?? null)}\n          className=\"block w-full text-sm\"\n          accept=\".txt,.md,.json,.xml\"\n        />\n        <div className=\"text-xs text-muted-foreground\">\n          MVP: chunking works for text-like files (txt/md/json/xml). You can still upload other files, but they won’t be chunked yet.\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-3\">\n        <button\n          onClick={upload}\n          disabled={busy}\n          className=\"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-primary-foreground disabled:opacity-60\"\n        >\n          {busy ? \"Uploading...\" : \"Upload to KB\"}\n        </button>\n        {status ? <div className=\"text-sm text-muted-foreground\">{status}</div> : null}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS,SAAS,EAAE,SAAS,EAAyB;IAC3D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAgB;IACpD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,eAAe;QACb,IAAI,CAAC,MAAM;YACT,UAAU;YACV;QACF;QACA,QAAQ;QACR,UAAU;QAEV,MAAM,KAAK,IAAI;QACf,GAAG,GAAG,CAAC,SAAS;QAChB,GAAG,GAAG,CAAC,QAAQ;QAEf,MAAM,MAAM,MAAM,MAAM,CAAC,cAAc,EAAE,UAAU,GAAG,CAAC,EAAE;YACvD,QAAQ;YACR,MAAM;QACR;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM;QAE1C,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,UAAU,MAAM,SAAS,CAAC,eAAe,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;YACxD,QAAQ;YACR;QACF;QAEA,MAAM,WAAW;YACf,CAAC,UAAU,EAAE,MAAM,KAAK,YAAY,YAAY;YAChD,CAAC,QAAQ,EAAE,MAAM,cAAc,GAAG;YAClC,MAAM,UAAU,CAAC,MAAM,EAAE,KAAK,OAAO,EAAE,GAAG;SAC3C,CAAC,MAAM,CAAC;QAET,UAAU,SAAS,IAAI,CAAC;QACxB,SAAS;QACT,QAAQ;QACR,QAAQ;QAER,wBAAwB;QACxB,OAAO,QAAQ,CAAC,MAAM;IACxB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAAsB;;;;;;kCACvC,8OAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,WAAU;wBACV,aAAY;;;;;;;;;;;;0BAIhB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAAsB;;;;;;kCACvC,8OAAC;wBACC,MAAK;wBACL,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;wBAChD,WAAU;wBACV,QAAO;;;;;;kCAET,8OAAC;wBAAI,WAAU;kCAAgC;;;;;;;;;;;;0BAKjD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,UAAU;wBACV,WAAU;kCAET,OAAO,iBAAiB;;;;;;oBAE1B,uBAAS,8OAAC;wBAAI,WAAU;kCAAiC;;;;;+BAAgB;;;;;;;;;;;;;AAIlF"}}]
}